{"ast":null,"code":"import _classCallCheck from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/billbuff/projects/academy/capstone/ProperT-react/src/App.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport store from 'store';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nimport LDClient from 'ldclient-js';\nimport Landing from './components/Landing';\nimport AccountManagement from './components/AccountManagement';\nimport PropertyDetails from './components/PropertyDetails';\nimport Nav from './components/Nav';\nimport Footer from './components/Footer';\nimport './App.css';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this));\n\n    _this.componentDidMount = function () {\n      var isLoggedIn = _this.state.isLoggedIn;\n\n      if (isLoggedIn) {\n        _this.checkTokenStatus();\n\n        _this.getAllRentals();\n      }\n\n      var user = {\n        key: 'allusers'\n      };\n      _this.ldclient = LDClient.initialize('5c08a03c1412625ab643f790', user);\n\n      _this.ldclient.on('ready', _this.onLaunchDarklyReady.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    };\n\n    _this.onLaunchDarklyReady = function () {\n      _this.setState({\n        featureFlags: {\n          googleAuthEnabled: _this.ldclient.variation('propert-google-auth')\n        }\n      });\n    };\n\n    _this.checkTokenStatus = function () {\n      axios.get('https://proper-t-express.herokuapp.com/auth/verify', {\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token')\n        }\n      }) // eslint-disable-next-line no-console\n      .then(function () {\n        return console.log('Token is valid');\n      }).catch(function () {\n        _this.handleLogout(); // eslint-disable-next-line no-alert\n\n\n        alert('Your session has expired please sign in again');\n      });\n      return false;\n    };\n\n    _this.handleLoggedInUser = function () {\n      _this.setState({\n        isLoggedIn: true\n      });\n    };\n\n    _this.getAllRentals = function () {\n      axios.get('https://proper-t-express.herokuapp.com/rentals', {\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token')\n        }\n      }).then(function (response) {\n        _this.setState({\n          rentals: response.data\n        }); // eslint-disable-next-line no-console\n\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.updateCurrentRental = function (rental) {\n      var currentRental = _this.state.currentRental;\n\n      var rentalEdited = _.isEqual(currentRental, rental);\n\n      if (!rentalEdited) {\n        _this.getAllRentals();\n      }\n\n      store.set('currentRental', rental);\n\n      _this.setState({\n        currentRental: store.get('currentRental')\n      });\n    };\n\n    _this.handleLogout = function () {\n      sessionStorage.removeItem('jwt_token');\n\n      _this.setState({\n        isLoggedIn: false\n      });\n\n      sessionStorage.clear();\n      store.clearAll();\n    };\n\n    var loginStatus = !!sessionStorage.getItem('jwt_token');\n    _this.state = {\n      isLoggedIn: loginStatus,\n      rentals: [],\n      currentRental: store.get('currentRental') || {}\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      // eslint-disable-next-line object-curly-newline\n      var _this$state = this.state,\n          isLoggedIn = _this$state.isLoggedIn,\n          currentRental = _this$state.currentRental,\n          rentals = _this$state.rentals,\n          featureFlags = _this$state.featureFlags;\n      return React.createElement(Router, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(Nav, {\n        currentRental: currentRental,\n        updateCurrentRental: this.updateCurrentRental,\n        isLoggedIn: isLoggedIn,\n        handleLogout: this.handleLogout,\n        rentals: rentals,\n        getAllRentals: this.getAllRentals,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(\"main\", {\n        id: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        render: function render(props) {\n          return React.createElement(Landing, Object.assign({}, props, {\n            isLoggedIn: isLoggedIn,\n            handleLoggedInUser: _this2.handleLoggedInUser,\n            featureFlags: featureFlags,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/user\",\n        render: function render() {\n          return isLoggedIn ? React.createElement(AccountManagement, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 122\n            },\n            __self: this\n          }) : React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 123\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/rentals/:id/\",\n        render: function render(props) {\n          return isLoggedIn ? React.createElement(PropertyDetails, Object.assign({}, props, {\n            currentRental: currentRental,\n            updateCurrentRental: _this2.updateCurrentRental,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          })) : React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      })), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/billbuff/projects/academy/capstone/ProperT-react/src/App.jsx"],"names":["React","Component","axios","_","store","BrowserRouter","Router","Route","Redirect","LDClient","Landing","AccountManagement","PropertyDetails","Nav","Footer","App","componentDidMount","isLoggedIn","state","checkTokenStatus","getAllRentals","user","key","ldclient","initialize","on","onLaunchDarklyReady","bind","setState","featureFlags","googleAuthEnabled","variation","get","headers","sessionStorage","getItem","then","console","log","catch","handleLogout","alert","handleLoggedInUser","response","rentals","data","err","error","updateCurrentRental","rental","currentRental","rentalEdited","isEqual","set","removeItem","clear","clearAll","loginStatus","props"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport store from 'store';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nimport LDClient from 'ldclient-js';\nimport Landing from './components/Landing';\nimport AccountManagement from './components/AccountManagement';\nimport PropertyDetails from './components/PropertyDetails';\nimport Nav from './components/Nav';\nimport Footer from './components/Footer';\nimport './App.css';\n\nclass App extends Component {\n  constructor() {\n    super();\n    const loginStatus = !!sessionStorage.getItem('jwt_token');\n    this.state = {\n      isLoggedIn: loginStatus,\n      rentals: [],\n      currentRental: store.get('currentRental') || {},\n    };\n  }\n\n  componentDidMount = () => {\n    const { isLoggedIn } = this.state;\n    if (isLoggedIn) {\n      this.checkTokenStatus();\n      this.getAllRentals();\n    }\n    const user = {\n      key: 'allusers',\n    };\n    this.ldclient = LDClient.initialize('5c08a03c1412625ab643f790', user);\n    this.ldclient.on('ready', this.onLaunchDarklyReady.bind(this));\n  }\n\n  onLaunchDarklyReady = () => {\n    this.setState({\n      featureFlags: { googleAuthEnabled: this.ldclient.variation('propert-google-auth') },\n    });\n  }\n\n  checkTokenStatus = () => {\n    axios.get('https://proper-t-express.herokuapp.com/auth/verify', {\n      headers: { 'x-access-token': sessionStorage.getItem('jwt_token') },\n    })\n      // eslint-disable-next-line no-console\n      .then(() => console.log('Token is valid'))\n      .catch(() => {\n        this.handleLogout();\n        // eslint-disable-next-line no-alert\n        alert('Your session has expired please sign in again');\n      });\n\n    return false;\n  }\n\n  handleLoggedInUser = () => {\n    this.setState({\n      isLoggedIn: true,\n    });\n  }\n\n  getAllRentals = () => {\n    axios.get('https://proper-t-express.herokuapp.com/rentals', {\n      headers: { 'x-access-token': sessionStorage.getItem('jwt_token') },\n    }).then((response) => {\n      this.setState({ rentals: response.data });\n    // eslint-disable-next-line no-console\n    }).catch(err => console.error(err));\n  }\n\n  updateCurrentRental = (rental) => {\n    const { currentRental } = this.state;\n    const rentalEdited = _.isEqual(currentRental, rental);\n    if (!rentalEdited) {\n      this.getAllRentals();\n    }\n    store.set('currentRental', rental);\n    this.setState({ currentRental: store.get('currentRental') });\n  }\n\n  handleLogout = () => {\n    sessionStorage.removeItem('jwt_token');\n    this.setState({ isLoggedIn: false });\n    sessionStorage.clear();\n    store.clearAll();\n  }\n\n  render() {\n    // eslint-disable-next-line object-curly-newline\n    const { isLoggedIn, currentRental, rentals, featureFlags } = this.state;\n    return (\n      <Router>\n        <div className=\"App\">\n          <Nav\n            currentRental={currentRental}\n            updateCurrentRental={this.updateCurrentRental}\n            isLoggedIn={isLoggedIn}\n            handleLogout={this.handleLogout}\n            rentals={rentals}\n            getAllRentals={this.getAllRentals}\n          />\n          <main id=\"main\">\n            <Route\n              exact\n              path=\"/\"\n              render={props => (\n                <Landing\n                  {...props}\n                  isLoggedIn={isLoggedIn}\n                  handleLoggedInUser={this.handleLoggedInUser}\n                  featureFlags={featureFlags}\n                />\n              )}\n            />\n            <Route\n              path=\"/user\"\n              render={() => (\n                isLoggedIn\n                  ? <AccountManagement />\n                  : <Redirect to=\"/\" />\n              )}\n            />\n            <Route\n              path=\"/rentals/:id/\"\n              render={props => (\n                isLoggedIn\n                  ? (\n                    <PropertyDetails\n                      {...props}\n                      currentRental={currentRental}\n                      updateCurrentRental={this.updateCurrentRental}\n                    />)\n                  : <Redirect to=\"/\" />\n              )}\n            />\n          </main>\n          <Footer />\n        </div>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}