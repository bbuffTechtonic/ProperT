{"ast":null,"code":"import _classCallCheck from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/billbuff/projects/academy/capstone/ProperT-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/billbuff/projects/academy/capstone/ProperT-react/src/components/expenses/ExpenseDetails.jsx\";\n\n/* eslint-disable no-console */\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport TableButtons from './TableButtons';\nimport TableNav from './TableNav';\nimport DisplayTable from './Table';\nimport AddExpense from './AddExpense';\nimport TableSelect from './TableSelect';\nimport '../../styles/PropDetails.css'; // import defaultImage from '../../images/images.png';\n\nvar ExpenseDetails =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ExpenseDetails, _Component);\n\n  function ExpenseDetails(props) {\n    var _this;\n\n    _classCallCheck(this, ExpenseDetails);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExpenseDetails).call(this, props));\n\n    _this.handleDelete = function () {\n      _this.setState({\n        searchInput: ''\n      });\n\n      _this.selectedCheckboxes.forEach(function (id) {\n        axios({\n          url: \"https://proper-t-express.herokuapp.com/rentals/expenses/\".concat(id),\n          method: 'delete',\n          headers: {\n            'x-access-token': sessionStorage.getItem('jwt_token'),\n            'Content-Type': 'application/json'\n          }\n        }).then(function () {\n          _this.getAllExpenses();\n        }).catch(function (err) {\n          return console.error(err);\n        });\n      });\n    };\n\n    _this.handleModalToggle = function () {\n      _this.setState({\n        searchInput: ''\n      });\n\n      _this.getAllExpenses();\n\n      var modal = _this.state.modal;\n\n      _this.setState({\n        modal: !modal\n      });\n    };\n\n    _this.handleModalToggleSubmit = function (e) {\n      var result = e.currentTarget.form.checkValidity();\n\n      if (result) {\n        _this.setState({\n          searchInput: ''\n        });\n\n        _this.getAllExpenses();\n\n        var modal = _this.state.modal;\n\n        _this.setState({\n          modal: !modal\n        });\n      }\n\n      return null;\n    };\n\n    _this.handleSearch = function (e) {\n      e.preventDefault();\n      var value = e.target.value;\n\n      _this.setState({\n        searchInput: value\n      });\n\n      _this.getAllExpenses(value.trim());\n    };\n\n    _this.handleSelectedExpense = function (e) {\n      _this.setState({\n        searchInput: ''\n      });\n\n      var id = _this.props.rental._id;\n      var currentYear = _this.state.currentYear;\n      var selectedExpense = e.target.value || e.target.textContent; // eslint-disable-next-line no-unused-expressions\n\n      selectedExpense === 'All' ? _this.getAllExpenses() : axios({\n        url: \"https://proper-t-express.herokuapp.com/rentals/\".concat(id, \"/expenses/\").concat(currentYear, \"/\").concat(selectedExpense),\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token')\n        }\n      }).then(function (expenses) {\n        _this.setState({\n          currentExpenses: expenses.data,\n          currentCategory: selectedExpense\n        });\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.getAllExpenses = function (searchValue) {\n      var id = _this.props.rental._id;\n      var currentYear = _this.state.currentYear;\n      var url; // eslint-disable-next-line no-unused-expressions\n\n      searchValue ? url = \"https://proper-t-express.herokuapp.com/rentals/\".concat(id, \"/expenses/\").concat(currentYear, \"?description=\").concat(searchValue) : url = \"https://proper-t-express.herokuapp.com/rentals/\".concat(id, \"/expenses/\").concat(currentYear);\n      axios({\n        url: url,\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token')\n        }\n      }).then(function (response) {\n        _this.setState({\n          currentExpenses: response.data,\n          currentCategory: 'All'\n        });\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.handleCheckAll = function () {\n      var checkAll = _this.state.checkAll;\n\n      if (checkAll) {\n        _this.selectedCheckboxes.forEach(function (id) {\n          console.log(id);\n        });\n      }\n\n      _this.setState({\n        checkAll: !checkAll\n      });\n    };\n\n    _this.updateSet = function (id) {\n      if (_this.selectedCheckboxes.has(id)) {\n        _this.selectedCheckboxes.delete(id);\n      } else {\n        _this.selectedCheckboxes.add(id);\n      }\n    };\n\n    _this.handleImageUpload = function () {\n      var preview = document.querySelector('#addExpenseImage');\n      var file = document.querySelector('#add-expense-form input[type=file]').files[0];\n      var reader = new FileReader();\n      reader.addEventListener('load', function () {\n        preview.src = reader.result;\n      }, false);\n\n      if (file) {\n        return reader.readAsDataURL(file);\n      }\n\n      return null;\n    };\n\n    _this.handleAddExpense = function (e) {\n      e.preventDefault();\n      var rental = e.target.dataset.rental;\n      axios({\n        url: \"https://proper-t-express.herokuapp.com/rentals/\".concat(rental, \"/expenses/\").concat(e.target[1].value),\n        method: 'post',\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token'),\n          'Content-Type': 'application/json'\n        },\n        data: {\n          date: e.target[0].value,\n          amount: e.target[2].value,\n          description: e.target[3].value,\n          image: document.getElementById('addExpenseImage').src\n        }\n      }).then(function () {\n        _this.getAllExpenses();\n      }).catch(function (error) {\n        console.error(error);\n      });\n    };\n\n    _this.getAllYears = function () {\n      var id = _this.props.rental._id;\n      axios.get(\"https://proper-t-express.herokuapp.com/rentals/\".concat(id, \"/years\"), {\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token')\n        }\n      }).then(function (response) {\n        _this.setState({\n          totalYears: response.data\n        });\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.handleYearSelect = function (e) {\n      var year = e.target.value;\n\n      _this.setState({\n        currentYear: year\n      });\n    };\n\n    var defaultDate = new Date().getFullYear();\n    _this.state = {\n      modal: false,\n      currentExpenses: [],\n      checkAll: false,\n      searchInput: '',\n      currentCategory: 'All',\n      currentYear: defaultDate,\n      totalYears: []\n    };\n\n    _this.handleYearSelect.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    return _this;\n  }\n\n  _createClass(ExpenseDetails, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getAllExpenses();\n      this.getAllYears();\n      this.selectedCheckboxes = new Set();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var rental = this.props.rental;\n      var currentYear = this.state.currentYear;\n\n      if (rental !== prevProps.rental) {\n        // eslint-disable-next-line react/no-did-update-set-state\n        this.setState({\n          searchInput: ''\n        });\n        this.getAllExpenses();\n        this.getAllYears();\n      }\n\n      if (prevState.currentYear !== currentYear) {\n        this.getAllExpenses();\n        this.getAllYears();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var expenseCategories = ['All', 'Rent', 'Mortgage', 'HOA', 'Mileage', 'Maintenance', 'Supplies', 'Misc']; // eslint-disable-next-line object-curly-newline, max-len\n\n      var _this$state = this.state,\n          modal = _this$state.modal,\n          currentExpenses = _this$state.currentExpenses,\n          checkAll = _this$state.checkAll,\n          searchInput = _this$state.searchInput,\n          currentCategory = _this$state.currentCategory,\n          currentYear = _this$state.currentYear,\n          totalYears = _this$state.totalYears;\n      var rental = this.props.rental;\n      return React.createElement(\"section\", {\n        id: \"expense-details\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(TableButtons, {\n        toggle: this.handleModalToggle,\n        handleSearch: this.handleSearch,\n        searchInput: searchInput,\n        onClick: this.handleDelete,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }), React.createElement(AddExpense, {\n        toggle: this.handleModalToggle,\n        toggleSubmit: this.handleModalToggleSubmit,\n        isOpen: modal,\n        rental: rental,\n        onSubmit: this.handleAddExpense,\n        onChange: this.handleImageUpload,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card mt-2\",\n        id: \"table-nav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body p-md-2 p-0\",\n        id: \"exp-nav-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(TableSelect, {\n        handleSelection: this.handleYearSelect,\n        currentSelection: currentYear,\n        options: totalYears,\n        selectStyles: \"custom-select m-auto mb-md-2 col-5 col-md-8 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }), React.createElement(TableSelect, {\n        handleSelection: this.handleSelectedExpense,\n        currentSelection: currentCategory,\n        options: expenseCategories,\n        selectStyles: \"d-md-none m-auto custom-select col-5 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      })), React.createElement(TableNav, {\n        selectExpense: this.handleSelectedExpense,\n        rental: rental,\n        currentCategory: currentCategory,\n        expenseCategories: expenseCategories,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      })))), React.createElement(DisplayTable, {\n        currentExpenses: currentExpenses,\n        handleCheckAll: this.handleCheckAll,\n        checkAll: checkAll,\n        onClick: this.updateSet,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return ExpenseDetails;\n}(Component);\n\nExpenseDetails.propTypes = {\n  rental: PropTypes.objectOf(PropTypes.oneOfType([PropTypes.string.isRequired, PropTypes.number.isRequired])).isRequired\n};\nexport default ExpenseDetails;","map":{"version":3,"sources":["/Users/billbuff/projects/academy/capstone/ProperT-react/src/components/expenses/ExpenseDetails.jsx"],"names":["React","Component","PropTypes","axios","TableButtons","TableNav","DisplayTable","AddExpense","TableSelect","ExpenseDetails","props","handleDelete","setState","searchInput","selectedCheckboxes","forEach","id","url","method","headers","sessionStorage","getItem","then","getAllExpenses","catch","err","console","error","handleModalToggle","modal","state","handleModalToggleSubmit","e","result","currentTarget","form","checkValidity","handleSearch","preventDefault","value","target","trim","handleSelectedExpense","rental","_id","currentYear","selectedExpense","textContent","expenses","currentExpenses","data","currentCategory","searchValue","response","handleCheckAll","checkAll","log","updateSet","has","delete","add","handleImageUpload","preview","document","querySelector","file","files","reader","FileReader","addEventListener","src","readAsDataURL","handleAddExpense","dataset","date","amount","description","image","getElementById","getAllYears","get","totalYears","handleYearSelect","year","defaultDate","Date","getFullYear","bind","Set","prevProps","prevState","expenseCategories","propTypes","objectOf","oneOfType","string","isRequired","number"],"mappings":"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","sourcesContent":["/* eslint-disable no-console */\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport TableButtons from './TableButtons';\nimport TableNav from './TableNav';\nimport DisplayTable from './Table';\nimport AddExpense from './AddExpense';\nimport TableSelect from './TableSelect';\nimport '../../styles/PropDetails.css';\n// import defaultImage from '../../images/images.png';\n\nclass ExpenseDetails extends Component {\n  constructor(props) {\n    super(props);\n    const defaultDate = new Date().getFullYear();\n    this.state = {\n      modal: false,\n      currentExpenses: [],\n      checkAll: false,\n      searchInput: '',\n      currentCategory: 'All',\n      currentYear: defaultDate,\n      totalYears: [],\n    };\n    this.handleYearSelect.bind(this);\n  }\n\n  componentDidMount() {\n    this.getAllExpenses();\n    this.getAllYears();\n    this.selectedCheckboxes = new Set();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { rental } = this.props;\n    const { currentYear } = this.state;\n    if (rental !== prevProps.rental) {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ searchInput: '' });\n      this.getAllExpenses();\n      this.getAllYears();\n    }\n    if (prevState.currentYear !== currentYear) {\n      this.getAllExpenses();\n      this.getAllYears();\n    }\n    return null;\n  }\n\n  handleDelete = () => {\n    this.setState({ searchInput: '' });\n    this.selectedCheckboxes.forEach((id) => {\n      axios({\n        url: `https://proper-t-express.herokuapp.com/rentals/expenses/${id}`,\n        method: 'delete',\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token'),\n          'Content-Type': 'application/json',\n        },\n      }).then(() => {\n        this.getAllExpenses();\n      }).catch(err => console.error(err));\n    });\n  }\n\n  handleModalToggle = () => {\n    this.setState({ searchInput: '' });\n    this.getAllExpenses();\n    const { modal } = this.state;\n    this.setState({ modal: !modal });\n  }\n\n  handleModalToggleSubmit = (e) => {\n    const result = e.currentTarget.form.checkValidity();\n    if (result) {\n      this.setState({ searchInput: '' });\n      this.getAllExpenses();\n      const { modal } = this.state;\n      this.setState({ modal: !modal });\n    }\n    return null;\n  }\n\n  handleSearch = (e) => {\n    e.preventDefault();\n    const { value } = e.target;\n    this.setState({ searchInput: value });\n    this.getAllExpenses(value.trim());\n  }\n\n  handleSelectedExpense = (e) => {\n    this.setState({ searchInput: '' });\n    const { rental: { _id: id } } = this.props;\n    const { currentYear } = this.state;\n    const selectedExpense = e.target.value || e.target.textContent;\n    // eslint-disable-next-line no-unused-expressions\n    selectedExpense === 'All'\n      ? this.getAllExpenses()\n      : axios({\n        url: `https://proper-t-express.herokuapp.com/rentals/${id}/expenses/${currentYear}/${selectedExpense}`,\n        headers: {\n          'x-access-token': sessionStorage.getItem('jwt_token'),\n        },\n      }).then((expenses) => {\n        this.setState({ currentExpenses: expenses.data, currentCategory: selectedExpense });\n      }).catch(err => console.error(err));\n  }\n\n  getAllExpenses = (searchValue) => {\n    const { rental: { _id: id } } = this.props;\n    const { currentYear } = this.state;\n    let url;\n    // eslint-disable-next-line no-unused-expressions\n    searchValue\n      ? url = `https://proper-t-express.herokuapp.com/rentals/${id}/expenses/${currentYear}?description=${searchValue}`\n      : url = `https://proper-t-express.herokuapp.com/rentals/${id}/expenses/${currentYear}`;\n    axios({\n      url,\n      headers: {\n        'x-access-token': sessionStorage.getItem('jwt_token'),\n      },\n    }).then((response) => {\n      this.setState({ currentExpenses: response.data, currentCategory: 'All' });\n    }).catch(err => console.error(err));\n  }\n\n  handleCheckAll = () => {\n    const { checkAll } = this.state;\n    if (checkAll) {\n      this.selectedCheckboxes.forEach((id) => {\n        console.log(id);\n      });\n    }\n    this.setState({ checkAll: !checkAll });\n  }\n\n  updateSet = (id) => {\n    if (this.selectedCheckboxes.has(id)) {\n      this.selectedCheckboxes.delete(id);\n    } else {\n      this.selectedCheckboxes.add(id);\n    }\n  }\n\n  handleImageUpload = () => {\n    const preview = document.querySelector('#addExpenseImage');\n    const file = document.querySelector('#add-expense-form input[type=file]').files[0];\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.src = reader.result;\n    }, false);\n\n    if (file) {\n      return reader.readAsDataURL(file);\n    }\n    return null;\n  }\n\n  handleAddExpense = (e) => {\n    e.preventDefault();\n    const { dataset: { rental } } = e.target;\n    axios({\n      url: `https://proper-t-express.herokuapp.com/rentals/${rental}/expenses/${e.target[1].value}`,\n      method: 'post',\n      headers: {\n        'x-access-token': sessionStorage.getItem('jwt_token'),\n        'Content-Type': 'application/json',\n      },\n      data: {\n        date: e.target[0].value,\n        amount: e.target[2].value,\n        description: e.target[3].value,\n        image: document.getElementById('addExpenseImage').src,\n      },\n    })\n      .then(() => {\n        this.getAllExpenses();\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  }\n\n  getAllYears = () => {\n    const { rental: { _id: id } } = this.props;\n    axios.get(`https://proper-t-express.herokuapp.com/rentals/${id}/years`, {\n      headers: {\n        'x-access-token': sessionStorage.getItem('jwt_token'),\n      },\n    }).then((response) => {\n      this.setState({ totalYears: response.data });\n    }).catch(err => console.error(err));\n  }\n\n  handleYearSelect = (e) => {\n    const year = e.target.value;\n    this.setState({ currentYear: year });\n  }\n\n  render() {\n    const expenseCategories = ['All', 'Rent', 'Mortgage', 'HOA', 'Mileage', 'Maintenance', 'Supplies', 'Misc'];\n    // eslint-disable-next-line object-curly-newline, max-len\n    const { modal, currentExpenses, checkAll, searchInput, currentCategory, currentYear, totalYears } = this.state;\n    const { rental } = this.props;\n    return (\n      <section id=\"expense-details\">\n        <TableButtons\n          toggle={this.handleModalToggle}\n          handleSearch={this.handleSearch}\n          searchInput={searchInput}\n          onClick={this.handleDelete}\n        />\n        <AddExpense\n          toggle={this.handleModalToggle}\n          toggleSubmit={this.handleModalToggleSubmit}\n          isOpen={modal}\n          rental={rental}\n          onSubmit={this.handleAddExpense}\n          onChange={this.handleImageUpload}\n        />\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            <div className=\"card mt-2\" id=\"table-nav\">\n              <div className=\"card-body p-md-2 p-0\" id=\"exp-nav-card\">\n                <div className=\"row\">\n                  <TableSelect\n                    handleSelection={this.handleYearSelect}\n                    currentSelection={currentYear}\n                    options={totalYears}\n                    selectStyles=\"custom-select m-auto mb-md-2 col-5 col-md-8 text-center\"\n                  />\n                  <TableSelect\n                    handleSelection={this.handleSelectedExpense}\n                    currentSelection={currentCategory}\n                    options={expenseCategories}\n                    selectStyles=\"d-md-none m-auto custom-select col-5 text-center\"\n                  />\n                </div>\n                <TableNav\n                  selectExpense={this.handleSelectedExpense}\n                  rental={rental}\n                  currentCategory={currentCategory}\n                  expenseCategories={expenseCategories}\n                />\n              </div>\n            </div>\n          </div>\n          <DisplayTable\n            currentExpenses={currentExpenses}\n            handleCheckAll={this.handleCheckAll}\n            checkAll={checkAll}\n            onClick={this.updateSet}\n          />\n        </div>\n      </section>\n    );\n  }\n}\n\nExpenseDetails.propTypes = {\n  rental: PropTypes.objectOf(PropTypes.oneOfType([\n    PropTypes.string.isRequired,\n    PropTypes.number.isRequired,\n  ])).isRequired,\n};\n\nexport default ExpenseDetails;\n"]},"metadata":{},"sourceType":"module"}